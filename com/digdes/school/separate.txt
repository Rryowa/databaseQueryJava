import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

public class Main {
    public static void main(String args[]) {
        String request1 = "age>=30 and age<40 or age>10 and age>80";
        String request2 = "age>=30 or age<40 and age>10 or age>80";
        String request3 = "age>=30 or age<40 or age>10 and age>80";
        
        //аналог mergeSort
        //массив с массивами, массивы с токенами and разделены запятыми, то есть or
        //если есть or, разбиваем на два массива слева от or и справа
        //рекурсивно идем по этим массивам, если в них есть or, то разбиваем на два
        //повторить
        
        //convert string to list
        ArrayList<String> str = new ArrayList<String>();
        str.add(request3);
        
        //call
        ArrayList<String> result = separate(str);
        
        for (String x : result) {
            System.out.println(x);
        }
    }
    
    //"age>=30 and age<40 or age>10 and age>80"
    public static ArrayList<String> separate(ArrayList<String> request){
        //convert list ot string
        String str = request.get(0);
    	if (!(str.contains("or"))) {
    		return request;
    	}
    	
    	//divide
    	ArrayList<ArrayList<String>> divide = splitter(str);
    	ArrayList<String> one = separate(divide.get(0));
    	ArrayList<String> two = separate(divide.get(1));
    	ArrayList<String> result = merge(one, two);
    	
    	return result;
    }
    
    public static ArrayList<String> merge(ArrayList<String> a, ArrayList<String> b) {
    	ArrayList<String> result = new ArrayList<String>();
    	for (String x : a) {
    	    result.add(x);
    	}
    	for (String x : b) {
    	    result.add(x);
    	}
    	return result;
    }
    //returns {{age>=30}, {"age<40andage>10orage>80"}}
    public static ArrayList<ArrayList<String>> splitter(String request){
        ArrayList<ArrayList<String>> divide = new ArrayList<ArrayList<String>>();
        int idx = request.indexOf("or");
        ArrayList<String> one = new ArrayList<String>();
        one.add(request.substring(0, idx));
        divide.add(one);
        ArrayList<String> two = new ArrayList<String>();
        two.add(request.substring(idx+3, request.length()));
        divide.add(two);
        return divide;
    }
}